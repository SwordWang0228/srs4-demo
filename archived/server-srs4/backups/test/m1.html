<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    button {
      font-size: 1rem;
      width: 10rem;
      height: 3rem;
      margin-top: .5rem;
    }
  </style>
</head>

<body>
  <button onclick="streamer.start()">开始传送麦克风</button>
  <button onclick="streamer.stop()">停止</button>
  <button onclick="player.start()">开始播放</button>
  <button onclick="player.stop()">停止播放</button>
  <br>
  <br>
  <a href="#" class="mute" onclick="voiceMute()" style="display:none">Mute</a>
  <br>
  <br>
  <input id="volume" type="range" min="0.0" max="1.0" step="0.01" oninput="setVol(this.value)"
    onchange="setVol(this.value)" style="-webkit-appearance: slider-vertical;display:none">
  <input type="text" id="volumeIndicator" style="display:none">
</body>
<script src="js/AudioControllerApi.js"></script>
<script src="js/xaudio.js"></script>
<script src="js/opus.js"></script>
<script src="js/libopus.js"></script>
<script>

  var defaultConfig = {
    codec: {
      sampleRate: 24000,
      channels: 1,
      app: 2048,
      frameDuration: 20,
      bufferSize: 4096
    },
    server: 'wss://' + window.location.hostname + '/wss'
  }
  console.log('wss://' + window.location.hostname + '/wss')

  //实例化接收
  var player = new AudioControllerApi.Player(defaultConfig); 
  //实例化麦克风发送
  var streamer = new AudioControllerApi.Streamer(defaultConfig);
  console.log(player)
  console.log(streamer)
  /*
  var mute = document.querySelector('.mute');
  var volume = document.querySelector('#volume');
  var volumeIndicator = document.querySelector('#volumeIndicator');
  volumeIndicator.value = player.getVolume();

  function setVol(val) {
    player.setVolume(val);
    volumeIndicator.value = player.getVolume();
  }
  */

  function voiceMute() {
    if (mute.id == "") {
      streamer.mute();
      mute.id = "activated";
      mute.innerHTML = "Unmute";
    } else {
      streamer.unMute();
      mute.id = "";
      mute.innerHTML = "Mute";
    }
  }



</script>

</html>